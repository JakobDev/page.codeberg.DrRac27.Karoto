app-id: page.codeberg.DrRac27.Karoto
runtime: org.kde.Platform
runtime-version: "6.5"
sdk: org.kde.Sdk
base: com.riverbankcomputing.PyQt.BaseApp
base-version: "6.5"
command: karoto
finish-args:
  - "--share=ipc"
  - "--socket=wayland"
  - "--socket=fallback-x11"
  - "--device=dri"

cleanup:
  - /include
  - /lib/pkgconfig
  - '*.la'
  - '*.a'
cleanup-commands:
  - /app/cleanup-BaseApp.sh
build-options:
  env:
    - BASEAPP_REMOVE_WEBENGINE=1
rename-desktop-file: karoto.desktop
modules:
  - name: karoto
    buildsystem: simple
    build-commands:
      - pip3 install --no-deps --prefix=${FLATPAK_DEST} karoto-0.1-py3-none-any.whl
      - install -Dm644 packaging/karoto.svg ${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/${FLATPAK_ID}.svg
      - install -Dm644 packaging/karoto.desktop ${FLATPAK_DEST}/share/applications/karoto.desktop
      - desktop-file-edit --set-icon=${FLATPAK_ID} ${FLATPAK_DEST}/share/applications/karoto.desktop
      - install -Dm644 org.codeberg.DrRac27.Karoto.metainfo.xml ${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.metainfo.xml
      - sed -i 's/org.codeberg/page.codeberg/g' ${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.metainfo.xml
    sources:
      - type: file
        url: https://codeberg.org/DrRac27/karoto/raw/commit/9fc57e919eff7f2656903f888c150483b7cdefa6/packaging/org.codeberg.DrRac27.Karoto.metainfo.xml
        sha256: 5a7ad280f12ad55bc75d1b976597b010e13a8e7e8a47f2d8a646f100187d425d # TODO: Remove in v0.2
      - type: file
        url: https://files.pythonhosted.org/packages/59/17/6ad132d97f545b73ea703292171d2606411faaf8e3f9d316ef19cbb74fd9/karoto-0.1-py3-none-any.whl
        sha256: e743f3682b80e42e11244cb56e5c46c930505eeada2c6ec6f54d7f2018199156
      - type: git
        url: https://codeberg.org/DrRac27/karoto.git
        tag: "0.1"
        commit: dee4b967580ad6319fa359e109d478af4eb54d6c
